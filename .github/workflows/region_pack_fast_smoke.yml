name: Region Pack Fast Smoke

on:
  workflow_dispatch:
  schedule:
    # Mondays at 04:13 UTC
    - cron: "13 4 * * 1"

jobs:
  region-pack-fast:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
          cache: "pip"

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          pip install -r requirements_viz.txt

      - name: Run GalaxyCandidates (2 regions, 2000 rows each)
        run: |
          python tools/run_regions_fast.py             --kind galaxy_candidates             --inputs "data/region_pack/raw/GalaxyCandidates_*.csv.gz"             --out "results/region_pack_fast/galaxy_candidates"             --max-regions 2             --max-rows 2000

      - name: Run VariSummary (2 regions, 2000 rows each)
        run: |
          python tools/run_regions_fast.py             --kind vari_summary             --inputs "data/region_pack/raw/VariSummary_*.csv.gz"             --out "results/region_pack_fast/vari_summary"             --max-regions 2             --max-rows 2000

      - name: Upload region pack artifacts
        uses: actions/upload-artifact@v4
        with:
          name: region_pack_fast_results
          path: results/region_pack_fast
